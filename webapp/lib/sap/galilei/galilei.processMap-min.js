(function(){var oModelDef={contents:{"Sap.Modeling.ProcessMap.Model":{classDefinition:"sap.galilei.model.Package",displayName:"Sap Modeling Process Map Model",namespaceName:"sap.modeling.processMap",classifiers:{Model:{displayName:"Model",parent:"sap.galilei.common.Model",references:{"Model.businessFunctions":{name:"businessFunctions",contentType:"sap.modeling.processMap.BusinessFunction",isMany:true,isContainment:true},"Model.processes":{name:"processes",contentType:"sap.modeling.processMap.Process",isMany:true,isContainment:true},"Model.dependencies":{name:"dependencies",contentType:"sap.modeling.processMap.Dependency",isMany:true,isContainment:true}}},BusinessFunction:{displayName:"Business Function",parent:"sap.galilei.common.NamedObject",properties:{},references:{"BusinessFunction.businessFunctions":{name:"businessFunctions",contentType:"sap.modeling.processMap.BusinessFunction",isMany:true,isContainment:true},"BusinessFunction.processes":{name:"processes",contentType:"sap.modeling.processMap.Process",isMany:true,isContainment:true},"BusinessFunction.dependencies":{name:"dependencies",contentType:"sap.modeling.processMap.Dependency",isMany:true,isContainment:true}}},Process:{displayName:"Process",parent:"sap.galilei.common.NamedObject",properties:{"Process.numberId":{name:"numberId",displayName:"Number ID",dataType:sap.galilei.model.dataTypes.gInteger},"Process.qualifiedNumberId":{name:"qualifiedNumberId",displayName:"Qualified number ID",get:function(){var sParentNumberId,sQualifiedNumberId;if(this.container&&sap.galilei.model.isInstanceOf(this.container,"sap.modeling.processMap.Process")){sParentNumberId=this.container.qualifiedNumberId}if(!isNaN(this.numberId)&&this.numberId>0){sQualifiedNumberId=String(this.numberId);if(sParentNumberId){sQualifiedNumberId=sParentNumberId+"."+sQualifiedNumberId}}return sQualifiedNumberId}},"Process.numberAndName":{name:"numberAndName",get:function(){var sValue=this.qualifiedNumberId;if(this.name){if(sValue){sValue+=". "+this.name}else{sValue=this.name}}return sValue}}},references:{"Process.processes":{name:"processes",contentType:"sap.modeling.processMap.Process",isMany:true,isContainment:true},"Process.dependencies":{name:"dependencies",contentType:"sap.modeling.processMap.Dependency",isMany:true,isContainment:true}}},Dependency:{displayName:"Dependency",parent:"sap.galilei.common.LinkObject"}}}}},oResource=new sap.galilei.model.Resource(),oReader=new sap.galilei.model.JSONReader();oReader.load(oResource,oModelDef)}());
namespace("sap.modeling.processMap");namespace("sap.modeling.processMap.ui");
(function(){var oResource,oReader,oSymbolClass,oDiagramDef={contents:{"Sap.Modeling.ProcessMap.Diagram":{classDefinition:"sap.galilei.model.Package",displayName:"Sap Modeling Process Map Diagram",namespaceName:"sap.modeling.processMap.ui",classifiers:{Diagram:{displayName:"Diagram",parent:"sap.galilei.ui.diagram.Diagram"},BusinessFunctionSymbol:{displayName:"Business Function Symbol",parent:"sap.galilei.ui.diagram.CompositeSymbol",properties:{"BusinessFunctionSymbol.isExpanded":{name:"isExpanded",dataType:sap.galilei.model.dataTypes.gBool,defaultValue:false}},statics:{objectClass:{value:"sap.modeling.processMap.BusinessFunction"},layoutTemplate:{mainShape:[{shape:"Rectangle",domClass:"businessFunction",stroke:"#7D8EC4",strokeWidth:1,fill:"#D9DDEA",width:200,height:120,minWidth:60,minHeight:40}],contentShape:{shape:"Stack",horizontalAlignment:"width",verticalAlignment:"height",innerPadding:0,contentPosition:1,contentMargin:"{isExpanded:contentMargin}",paddingLeft:4,paddingRight:4,paddingTop:4,shapes:[{shape:"Text",domClass:"businessFunctionName",text:"{object/name}",font:"12px Arial, Helvetica, sans-serif",fill:"black",horizontalAlignment:"{isExpanded:horzTextAlignment}",verticalAlignment:"{isExpanded:vertTextAlignment}",isWordWrap:true,isEllipsis:true}]}},formatters:{horzTextAlignment:function(vValue,oObject){return this.isExpanded?"left":"width"},vertTextAlignment:function(vValue,oObject){return this.isExpanded?"top":"height"},contentMargin:function(){return this.isExpanded?8:0}}}},ProcessSymbol:{displayName:"Process Symbol",parent:"sap.galilei.ui.diagram.CompositeSymbol",properties:{"ProcessSymbol.isExpanded":{name:"isExpanded",dataType:sap.galilei.model.dataTypes.gBool,defaultValue:false},"ProcessSymbol.symbolLayouter":{name:"symbolLayouter",get:function(){var self=this;function getOffset(){var oShape=self.getBoundaryShape();if(oShape&&oShape.horizontalOffset!==undefined){return oShape.horizontalOffset}return sap.galilei.ui.common.shape.Process.HORIZONTAL_OFFSET-sap.galilei.ui.common.shape.Process.getArrowLength(self.width,self.height)}return{className:"sap.galilei.ui.editor.layout.StackLayout",orientation:"horizontal",symbolClass:"sap.modeling.processMap.ui.ProcessSymbol",offsetX:getOffset}}}},statics:{objectClass:{value:"sap.modeling.processMap.Process"},layoutTemplate:{mainShape:[{shape:"Process",domClass:"process",stroke:"#428EB0",strokeWidth:1,fill:"#CCE9FC",width:120,height:60,minWidth:60,minHeight:40}],contentShape:{shape:"Stack",horizontalAlignment:"width",verticalAlignment:"height",innerAlignment:"center",contentPosition:1,contentMarginTop:"{isExpanded:contentMargin}",contentMarginBottom:"{isExpanded:contentMargin}",paddingLeft:2,paddingRight:2,paddingTop:2,paddingBottom:2,shapes:[{shape:"Text",domClass:"processName",text:"{object/numberAndName}",font:"12px Arial, Helvetica, sans-serif",fill:"black",horizontalAlignment:"width",verticalAlignment:"{isExpanded:textAlignment}",isWordWrap:true,isEllipsis:true}]}},formatters:{textAlignment:function(vValue,oObject){return this.isExpanded?"top":"height"},contentMargin:function(){return this.isExpanded?8:0}},parentSymbolHighlighter:{get:function(){return{className:"sap.modeling.processMap.ui.ProcessSymbolHighlighter",orientation:"horizontal",symbolClass:"sap.modeling.processMap.ui.ProcessSymbol"}}}}},DependencySymbol:{displayName:"Dependency Symbol",parent:"sap.galilei.ui.diagram.LinkSymbol",statics:{objectClass:{value:"sap.modeling.processMap.Dependency"},layoutTemplate:{domClass:"dependency",stroke:"#428EB0",strokeWidth:1,strokeDashArray:"3,3",lineStyle:"{lineStyle}",targetArrow:"Arrows.LineEnd"}}}}}}};oResource=new sap.galilei.model.Resource();oReader=new sap.galilei.model.JSONReader();oReader.load(oResource,oDiagramDef);oSymbolClass=sap.galilei.model.getClass("sap.modeling.processMap.ui.BusinessFunctionSymbol");if(oSymbolClass){oSymbolClass.addReferenceListener({onReferenceChanged:function(oEventArgs){var oInstance=oEventArgs.instance;if(oInstance&&!sap.galilei.model.isInUndoRedo()){oInstance.isExpanded=!(oInstance.contentSymbols.length===0)}}},"symbols")}oSymbolClass=sap.galilei.model.getClass("sap.modeling.processMap.ui.ProcessSymbol");if(oSymbolClass){oSymbolClass.addReferenceListener({onReferenceChanged:function(oEventArgs){var oInstance=oEventArgs.instance;if(oInstance&&!sap.galilei.model.isInUndoRedo()){oInstance.isExpanded=!(oInstance.contentSymbols.length===0)}}},"symbols")}}());
(function(){sap.modeling.processMap.ui.DiagramEditorExtension=sap.galilei.ui.editor.defineDiagramEditorExtension({fullClassName:"sap.modeling.processMap.ui.DiagramEditorExtension",properties:{BUSINESSFUNCTION_SYMBOL:"sap.modeling.processMap.ui.BusinessFunctionSymbol",PROCESS_SYMBOL:"sap.modeling.processMap.ui.ProcessSymbol",DEPENDENCY_SYMBOL:"sap.modeling.processMap.ui.DependencySymbol",BUSINESSFUNCTION_OBJECT:"sap.modeling.processMap.BusinessFunction",PROCESS_OBJECT:"sap.modeling.processMap.Process",DEPENDENCY_OBJECT:"sap.modeling.processMap.Dependency",BUSINESSFUNCTIONS_REFERENCE:"businessFunctions",PROCESSES_REFERENCE:"processes",DEPENDENCIES_REFERENCE:"dependencies",modelPackageName:"sap.modeling.processMap",diagramPackageName:"sap.modeling.processMap.ui",imagesFolder:"images"},methods:{canCreateSymbol:function(sSymbolClass,oCreateParam){var oParentSymbol,sParentSymbolClass,oRect,oParentRect,oSymbolLayout,oShape;if(!this.canCreateInstance(sSymbolClass)){return false}if(sSymbolClass&&oCreateParam){oParentSymbol=oCreateParam.parentSymbol;if(oParentSymbol){sParentSymbolClass=oParentSymbol.classDefinition.qualifiedName}switch(sSymbolClass){case this.BUSINESSFUNCTION_SYMBOL:if(sParentSymbolClass&&sParentSymbolClass!==this.BUSINESSFUNCTION_SYMBOL){return false}if(sap.galilei.model.isInstanceOf(this.diagram.container,this.PROCESS_OBJECT)){return false}break;case this.PROCESS_SYMBOL:if(sParentSymbolClass&&sParentSymbolClass!==this.BUSINESSFUNCTION_SYMBOL&&sParentSymbolClass!==this.PROCESS_SYMBOL){return false}if(sParentSymbolClass===this.PROCESS_SYMBOL){oParentRect=oCreateParam.parentSymbol.getBBox();if(oCreateParam.symbol){oRect=oCreateParam.symbol.getBBox()}else{oSymbolLayout=sap.galilei.ui.diagram.Symbol.getOrCreateSymbolLayout(oParentSymbol.classDefinition);if(oSymbolLayout&&oSymbolLayout.mainShape){oShape=oSymbolLayout.mainShape.shapes.length>0?oSymbolLayout.mainShape.shapes[0]:oSymbolLayout.mainShape;if(oShape){oRect=new sap.galilei.ui.common.Rect();oRect.width=oShape.width;oRect.height=oShape.height}}}if(oRect){if(oCreateParam.symbol&&oCreateParam.delta){oRect.x+=oCreateParam.delta[0];oRect.y+=oCreateParam.delta[1]}else{oRect.setCenter(oCreateParam.point[0],oCreateParam.point[1])}oRect.inflate(8);if(!oParentRect.isRectInRect(oRect)){return false}}}break}}return true},canCreateLinkSymbol:function(oSourceSymbol,oTargetSymbol,oLinkTool){if(oLinkTool!==undefined&&oSourceSymbol!==undefined&&oTargetSymbol!==undefined){}return this.defaultCanCreateLinkSymbol(oSourceSymbol,oTargetSymbol,oLinkTool)},selectLinkSymbolDefinition:function(oSourceSymbol,oTargetSymbol){var oTool=sap.galilei.ui.editor.tool.getTool(this.DEPENDENCY_SYMBOL);if(oTool&&oTool.selectLinkSymbolDefinition){return oTool.selectLinkSymbolDefinition(oSourceSymbol,oTargetSymbol)}return{linkSymbolClass:this.DEPENDENCY_SYMBOL}},getEditablePropertyInfo:function(oSymbol,oInfo){if(oSymbol&&oInfo&&oInfo.object&&oInfo.propertyName){if(oInfo.propertyName==="numberAndName"){oInfo.propertyName="name"}}return oInfo},getToolsDefinition:function(){var oToolsDef,aSourceTargets,aLinksDefinition=[],index,max,aSourceTarget;oToolsDef=[{name:this.BUSINESSFUNCTION_SYMBOL,type:sap.galilei.ui.editor.tool.Types.createNodeSymbolTool,tooltip:"Create Business Function",symbolClass:this.BUSINESSFUNCTION_SYMBOL,objectClass:this.BUSINESSFUNCTION_OBJECT,objectReference:this.BUSINESSFUNCTIONS_REFERENCE,smallIcon:"BusinessFunction16.png"},{name:this.PROCESS_SYMBOL,type:sap.galilei.ui.editor.tool.Types.createNodeSymbolTool,tooltip:"Create Process",symbolClass:this.PROCESS_SYMBOL,objectClass:this.PROCESS_OBJECT,objectReference:this.PROCESSES_REFERENCE,smallIcon:"Process16.png"}];aSourceTargets=[[this.PROCESS_SYMBOL,this.PROCESS_SYMBOL],[this.PROCESS_SYMBOL,this.BUSINESSFUNCTION_SYMBOL],[this.BUSINESSFUNCTION_SYMBOL,this.PROCESS_SYMBOL],[this.BUSINESSFUNCTION_SYMBOL,this.BUSINESSFUNCTION_SYMBOL]];for(index=0,max=aSourceTargets.length;index<max;index++){aSourceTarget=aSourceTargets[index];this.addLinkDefinition(aLinksDefinition,aSourceTarget[0],aSourceTarget[1],this.DEPENDENCY_SYMBOL,this.DEPENDENCIES_REFERENCE)}oToolsDef.push({name:this.DEPENDENCY_SYMBOL,type:sap.galilei.ui.editor.tool.Types.createLinkSymbolTool,tooltip:"Create Dependency Link",smallIcon:"Dependency16.png",cursor:"DependencyCursor.png",linksDefinition:aLinksDefinition});this.addImagesFolder(oToolsDef);return oToolsDef},getContextButtonPad:function(oSymbol){var aButtons=[];if(oSymbol){switch(oSymbol.classDefinition.qualifiedName){case this.BUSINESSFUNCTION_SYMBOL:aButtons.push({toolName:this.BUSINESSFUNCTION_SYMBOL});aButtons.push({toolName:this.DEPENDENCY_SYMBOL});break;case this.PROCESS_SYMBOL:aButtons.push({toolName:this.PROCESS_SYMBOL});aButtons.push({toolName:this.DEPENDENCY_SYMBOL});break}}this.addImagesFolder(aButtons);return aButtons},getTopLevelTools:function(){var aTools=[];aTools.push({name:"BusinessFunction",toolName:this.BUSINESSFUNCTION_SYMBOL,isEnabled:this.canCreateInstance(this.BUSINESSFUNCTION_SYMBOL),largeIcon:"BusinessFunction.png"});aTools.push({name:"Process",toolName:this.PROCESS_SYMBOL,isEnabled:this.canCreateInstance(this.PROCESS_SYMBOL),largeIcon:"Process.png"});aTools.push({name:"Dependency",toolName:this.DEPENDENCY_SYMBOL,isEnabled:this.canCreateInstance(this.DEPENDENCY_SYMBOL),largeIcon:"Dependency.png"});return aTools}}})}());
(function(){sap.modeling.processMap.ui.Library=sap.galilei.ui.common.library.defineLibrary({fullClassName:"sap.modeling.processMap.ui.Library",libraryName:"ProcessMap",statics:{onInitialize:function(){this.addShape("CompositeIcon",{shape:"Path",domClass:"processIconStroke",path:"M0,0L0,12L12,12L12,0ZM2,6L10,6M6,2L6,10",stroke:"#428EB0",fill:"white",fillOpacity:0.01,strokeWidth:1})}}})}());
(function(){sap.modeling.processMap.ui.ProcessSymbolHighlighter=sap.galilei.core.defineClass({fullClassName:"sap.modeling.processMap.ui.ProcessSymbolHighlighter",parent:sap.galilei.ui.editor.tracker.StackSymbolHighlighter,properties:{x:undefined,y:undefined,width:undefined,height:undefined},methods:{getHighlightPoints:function(oSymbol,bBefore){var x,y,width,height,nLength,nDefaultSize=sap.galilei.ui.common.shape.Process.HORIZONTAL_OFFSET,aPoints=[];if(oSymbol){width=oSymbol.width;height=oSymbol.height;nLength=sap.galilei.ui.common.shape.Process.getArrowLength(width,height);if(bBefore){x=oSymbol.x+nLength-nDefaultSize}else{x=oSymbol.x+width}y=oSymbol.y;aPoints=[];aPoints.push([x-nLength,y]);aPoints.push([x-nLength+nDefaultSize,y]);aPoints.push([x+nDefaultSize,y+height/2]);aPoints.push([x-nLength+nDefaultSize,y+height]);aPoints.push([x-nLength,y+height]);aPoints.push([x,y+height/2]);aPoints.push([x-nLength,y]);this.x=x;this.y=y;this.width=width;this.height=height}return aPoints},createHighlightShape:function(oSymbol,bBefore){var aPoints;if(oSymbol&&!this._highlightShape){aPoints=this.getHighlightPoints(oSymbol,bBefore);if(aPoints){this._highlightShape=new sap.galilei.ui.common.shape.Polygon({points:aPoints,stroke:this.highlightColor,fill:this.highlightColor,opacity:0.8});this._highlightShape.draw(this.viewer,this.viewer.d3ShapeDecoratorLayer,this.transitionDefinition)}}},updateHighlightShape:function(oSymbol,bBefore){var aPoints;if(oSymbol&&this._highlightShape&&(oSymbol.x!==this.x||oSymbol.y!==this.y||oSymbol.width!==this.width||oSymbol.height!==this.height)){aPoints=this.getHighlightPoints(oSymbol,bBefore);if(aPoints){this._highlightShape.set({points:aPoints});this._highlightShape.updateDrawing(this.viewer,undefined,["points"])}}}}})}());
