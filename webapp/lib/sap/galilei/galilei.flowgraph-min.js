namespace("sap.modeling.flowgraph");namespace("sap.modeling.flowgraph.ui");
(function(){var oResource,oReader,oModelDef={contents:{"Sap.Modeling.FlowGraph.Model":{classDefinition:"sap.galilei.model.Package",displayName:"Flow Graph Model",namespaceName:"sap.modeling.flowgraph",classifiers:{SubGraph:{displayName:"SubGraph",parent:"sap.galilei.common.NamedObject",properties:{},references:{"SubGraph.subgraphs":{name:"subgraphs",contentType:"sap.modeling.flowgraph.SubGraph",isMany:true,isContainment:false},"SubGraph.nodes":{name:"nodes",contentType:"sap.modeling.flowgraph.Node",isMany:true,isContainment:false},"SubGraph.flows":{name:"flows",contentType:"sap.modeling.flowgraph.Flow",isMany:true,isContainment:false}}},Node:{displayName:"Node",parent:"sap.galilei.common.NamedObject",properties:{},references:{inputs:{name:"inputs",contentType:"sap.modeling.flowgraph.Input",isMany:true,isContainment:true},outputs:{name:"outputs",contentType:"sap.modeling.flowgraph.Output",isMany:true,isContainment:true}}},Input:{displayName:"Input",parent:"sap.galilei.common.NamedObject",properties:{"Intput.node":{name:"node",get:function(){return this.container}},"Input.type":{name:"type",dataType:sap.galilei.model.dataTypes.gString,defaultValue:"normal"}}},Output:{displayName:"Output",parent:"sap.galilei.common.NamedObject",properties:{"Output.node":{name:"node",get:function(){return this.container}},"Output.type":{name:"type",dataType:sap.galilei.model.dataTypes.gString,defaultValue:"normal"}}},Flow:{displayName:"Flow",parent:"sap.galilei.common.LinkObject",properties:{sourceOutput:{get:function(){return this.source},set:function(oSource){this.source=oSource}},targetInput:{get:function(){return this.target},set:function(oSource){this.target=oSource}},sourceNode:{get:function(){return this.source&&this.source.container}},targetNode:{get:function(){return this.target&&this.target.container}}}},Model:{displayName:"Model",parent:"sap.galilei.common.Model",references:{"Model.subgraphs":{name:"subgraphs",contentType:"sap.modeling.flowgraph.SubGraph",isMany:true,isContainment:true},"Model.nodes":{name:"nodes",contentType:"sap.modeling.flowgraph.Node",isMany:true,isContainment:true},"Model.flows":{name:"flows",contentType:"sap.modeling.flowgraph.Flow",isMany:true,isContainment:true}}}}}}};oResource=new sap.galilei.model.Resource();oReader=new sap.galilei.model.JSONReader();oReader.load(oResource,oModelDef)}());
(function(){sap.modeling.flowgraph.ui.AddInputCommand=sap.galilei.core.defineClass({fullClassName:"sap.modeling.flowgraph.ui.AddInputCommand",parent:sap.galilei.ui.editor.command.Command,methods:{execute:function(oParam){var self=this,oInputSymbol;function addInput(){oInputSymbol=self.editor.createSymbolAndObject(self.editor.extension.INPUT_SYMBOL,{},self.symbol,undefined,undefined,self.editor.extension.INPUT_OBJECT_PARAM,undefined,undefined,undefined);if(oInputSymbol){self.symbol.updateBoundarySymbols(undefined,undefined,true,self.editor.viewer,self.editor.transitionDefinition);oInputSymbol.drawSymbol(self.editor.viewer,self.editor.transitionDefinition)}}if(oParam){this.getParameters(oParam);if(this.symbol&&this.editor){this.resource.applyUndoableAction(addInput,"Add input")}}}}})}());
(function(){sap.modeling.flowgraph.ui.AddOutputCommand=sap.galilei.core.defineClass({fullClassName:"sap.modeling.flowgraph.ui.AddOutputCommand",parent:sap.galilei.ui.editor.command.Command,methods:{execute:function(oParam){var self=this,oNode,oOutput,oOutputSymbol;function addOutput(){oOutputSymbol=self.editor.createSymbolAndObject(self.editor.extension.OUTPUT_SYMBOL,{},self.symbol,undefined,undefined,self.editor.extension.OUTPUT_OBJECT_PARAM,undefined,undefined,undefined);if(oOutputSymbol){self.symbol.updateBoundarySymbols(undefined,undefined,true,self.editor.viewer,self.editor.transitionDefinition);oOutputSymbol.drawSymbol(self.editor.viewer,self.editor.transitionDefinition)}}if(oParam){this.getParameters(oParam);if(this.symbol&&this.editor){this.resource.applyUndoableAction(addOutput,"Add output")}}}}})}());
(function(){var oResource,oReader,oDiagramDef={contents:{"Sap.Modeling.FlowGraph.Diagram":{classDefinition:"sap.galilei.model.Package",displayName:"Flow Graph Diagram",namespaceName:"sap.modeling.flowgraph.ui",classifiers:{Diagram:{displayName:"Diagram",parent:"sap.galilei.ui.diagram.Diagram"},SubGraphSymbol:{displayName:"SubGraph Symbol",parent:"sap.galilei.ui.diagram.CompositeSymbol",properties:{"SubGraphSymbol.isExpanded":{name:"isExpanded",dataType:sap.galilei.model.dataTypes.gBool,defaultValue:false}},statics:{objectClass:{value:"sap.modeling.flowgraph.SubGraph"},layoutTemplate:{mainShape:[{shape:"Rectangle",domClass:"SubGraph",stroke:"#7D8EC4",strokeWidth:1,fill:"#D9DDEA",width:200,height:120,minWidth:60,minHeight:40}],contentShape:{shape:"Stack",horizontalAlignment:"width",verticalAlignment:"height",innerPadding:0,contentPosition:1,contentMargin:"{isExpanded:contentMargin}",paddingLeft:4,paddingRight:4,paddingTop:4,shapes:[{shape:"Text",domClass:"SubGraphName",text:"{object/name}",font:"12px Arial, Helvetica, sans-serif",fill:"black",horizontalAlignment:"{isExpanded:horzTextAlignment}",verticalAlignment:"{isExpanded:vertTextAlignment}",isWordWrap:true,isEllipsis:true}]}},formatters:{horzTextAlignment:function(vValue,oObject){return this.isExpanded?"left":"width"},vertTextAlignment:function(vValue,oObject){return this.isExpanded?"top":"height"},contentMargin:function(){return this.isExpanded?8:0}}}},NodeSymbol:{displayName:"Node Symbol",parent:"sap.galilei.ui.diagram.CompositeSymbol",properties:{"NodeSymbol.isAdjustToContent":{name:"isAdjustToContent",defaultValue:false},"NodeSymbol.stroke":{name:"stroke",defaultValue:"#B3B3B3"},"NodeSymbol.strokeWidth":{name:"strokeWidth",defaultValue:1},"NodeSymbol.fill":{name:"fill",defaultValue:"#C9DFF1"},"NodeSymbol.font":{name:"font",defaultValue:"bold 12px Arial,sans-serif"},"NodeSymbol.textColor":{name:"textColor",defaultValue:"#333333"}},methods:{updateBoundarySymbols:function(oOldParentBBox,oNewParentBBox,bMoveLinkSymbols,oViewer,oTransitionDef){var self=this,nHeaderHeight=24,nAnchorHeight=14,nPaddingY=8,nInnerPaddingY=6,nStatusIconHeight=16,nMaxNodeHeight=90,nTotalHeight=0,nMaxWidth=0,bSizeNode=false,nOffsetY,cx,cy,index,max,aSymbols,oBoundarySymbol;this.getOrCreateShape();oNewParentBBox=oNewParentBBox||this.getBBox();function measureAnchorsSize(){var nHeight=0;for(index=0,max=self.boundarySymbols.length;index<max;index++){oBoundarySymbol=self.boundarySymbols.get(index);oBoundarySymbol.getOrCreateShape();nTotalHeight+=nAnchorHeight;if(index>0){nTotalHeight+=nInnerPaddingY}nMaxWidth=Math.max(nMaxWidth,oBoundarySymbol.width)}}measureAnchorsSize();nOffsetY=(oNewParentBBox.height-nHeaderHeight-nTotalHeight-nStatusIconHeight)/2;if(nOffsetY<nPaddingY){oNewParentBBox.height=nHeaderHeight+nPaddingY+nTotalHeight+nPaddingY+nStatusIconHeight;bSizeNode=true;nOffsetY=nPaddingY}if(oNewParentBBox.height!==nHeaderHeight+nTotalHeight+nPaddingY+nPaddingY+nStatusIconHeight){oNewParentBBox.height=nHeaderHeight+nTotalHeight+nPaddingY+nPaddingY+nStatusIconHeight;if(oNewParentBBox.height<nMaxNodeHeight){oNewParentBBox.height=nMaxNodeHeight}bSizeNode=true;nOffsetY=(oNewParentBBox.height-nHeaderHeight-nTotalHeight-nStatusIconHeight)/2}if(oNewParentBBox.width<nMaxWidth){oNewParentBBox.width=nMaxWidth;bSizeNode=true}if(bSizeNode){this.setBBox(oNewParentBBox,{moveLinkSymbols:bMoveLinkSymbols,updateBoundarySymbols:false},oViewer,oTransitionDef)}cx=oNewParentBBox.x;cy=oNewParentBBox.y+nHeaderHeight+nOffsetY+nAnchorHeight/2;aSymbols=[];for(index=0,max=this.boundarySymbols.length;index<max;index++){oBoundarySymbol=this.boundarySymbols.get(index);if(sap.galilei.model.isInstanceOf(oBoundarySymbol,"sap.modeling.flowgraph.ui.InputSymbol")){aSymbols.push(oBoundarySymbol)}}aSymbols.sort(function(oSymbol1,oSymbol2){return oSymbol1.y-oSymbol2.y});for(index=0,max=aSymbols.length;index<max;index++){oBoundarySymbol=aSymbols[index];if(sap.galilei.model.isInstanceOf(oBoundarySymbol,"sap.modeling.flowgraph.ui.InputSymbol")){this.setBoundarySymbolAttachPoint(oBoundarySymbol,cx,cy,bMoveLinkSymbols,oViewer,oTransitionDef);cy+=nAnchorHeight+nInnerPaddingY}}cx=oNewParentBBox.x+oNewParentBBox.width;aSymbols=[];for(index=0,max=this.boundarySymbols.length;index<max;index++){oBoundarySymbol=this.boundarySymbols.get(index);if(sap.galilei.model.isInstanceOf(oBoundarySymbol,"sap.modeling.flowgraph.ui.OutputSymbol")){aSymbols.push(oBoundarySymbol)}}aSymbols.sort(function(oSymbol1,oSymbol2){return oSymbol1.y-oSymbol2.y});for(index=0,max=aSymbols.length;index<max;index++){oBoundarySymbol=aSymbols[index];if(sap.galilei.model.isInstanceOf(oBoundarySymbol,"sap.modeling.flowgraph.ui.OutputSymbol")){this.setBoundarySymbolAttachPoint(oBoundarySymbol,cx,cy,bMoveLinkSymbols,oViewer,oTransitionDef);cy+=nAnchorHeight+nInnerPaddingY}}}},statics:{objectClass:{value:"sap.modeling.flowgraph.Node"},layoutTemplate:{mainShape:[{shape:"RoundedRectangle",r:4,domClass:"node",stroke:"{stroke}",strokeWidth:"{strokeWidth}",fill:"white",padding:0,width:90,height:90,minWidth:60,minHeight:80},{shape:"Panel",shapes:[{shape:"RoundedSameSideRectangle",r:3,stroke:"{stroke}",strokeWidth:"{strokeWidth}",height:24,dockPosition:"maxWidth",fill:"{fill}"},{shape:"Stack",dockPosition:"bottom",orientation:"horizontal",horizontalAlignment:sap.galilei.ui.common.HorizontalAlignment.width,isAdjustToContent:true,innerAlignment:"right",innerPadding:4,marginRight:4,marginBottom:4,shapes:[{shape:"Image",href:"images/Warning.png",width:16,height:16,events:{pointerdown:function(oEvent,oSymbol,oExtension){console.log("Clicked on the icon of node "+oSymbol.object.name)}}},{shape:"Image",href:"images/Node16.png",width:16,height:16,events:{pointerdown:function(oEvent,oSymbol,oExtension){console.log("Clicked on the icon of node "+oSymbol.object.name)}}}]}]}],contentShape:{shape:"Stack",horizontalAlignment:"width",verticalAlignment:"top",padding:0,innerPadding:0,shapes:[{shape:"Stack",orientation:"horizontal",padding:4,innerPadding:2,shapes:[{shape:"Image",href:"images/Node16.png",width:16,height:16},{shape:"Text",domClass:"nodeName",text:"{object/displayName}",font:"{font}",fill:"{textColor}",horizontalAlignment:"width",verticalAlignment:"height",isWordWrap:true,isEllipsis:true}]}]}}}},InputSymbol:{displayName:"Input Symbol",parent:"sap.galilei.ui.diagram.BoundarySymbol",properties:{"InputSymbol.isKeepPosition":{name:"isKeepPosition",defaultValue:true},"InputSymbol.offsetX":{name:"offsetX",get:function(){return this.width/2-this.height/2}},"Inputsymbol.boundaryDirection":{name:"boundaryDirection",defaultValue:sap.galilei.ui.common.PortSide.west},"Inputsymbol.stroke":{name:"stroke",defaultValue:"#B3B3B3"},"Inputsymbol.strokeWidth":{name:"strokeWidth",defaultValue:1},"Inputsymbol.fill":{name:"fill",defaultValue:"white"},"Inputsymbol.font":{name:"font",defaultValue:"12px Arial,sans-serif"},"Inputsymbol.textColor":{name:"textColor",defaultValue:"#333333"}},methods:{getAttachPoints:function(bIsSource){var oBBox=this.getBBox();return{isFixedPoints:true,points:[[oBBox.x+oBBox.height/2+1,oBBox.y+oBBox.height/2]]}}},statics:{objectClass:{value:"sap.modeling.flowgraph.Input"},layoutTemplate:{mainShape:[{shape:"RoundedRectangle",r:7,domClass:"node",stroke:"{stroke}",strokeWidth:"{strokeWidth}",fill:"{fill}",padding:0,width:50,height:14},{shape:"Text",domClass:"inputName",text:"{object/displayName}",font:"{font}",fill:"{textColor}",horizontalAlignment:"width",verticalAlignment:"height",isWordWrap:true,isEllipsis:true}]}}},OutputSymbol:{displayName:"Output Symbol",parent:"sap.galilei.ui.diagram.BoundarySymbol",properties:{"OutputSymbol.isKeepPosition":{name:"isKeepPosition",defaultValue:true},"OutputSymbol.offsetX":{name:"offsetX",get:function(){return -this.width/2+this.height/2}},"OutputSymbol.boundaryDirection":{name:"boundaryDirection",defaultValue:sap.galilei.ui.common.PortSide.east},"OutputSymbol.stroke":{name:"stroke",defaultValue:"#B3B3B3"},"OutputSymbol.strokeWidth":{name:"strokeWidth",defaultValue:1},"OutputSymbol.fill":{name:"fill",defaultValue:"white"},"OutputSymbol.font":{name:"font",defaultValue:"12px Arial,sans-serif"},"OutputSymbol.textColor":{name:"textColor",defaultValue:"#333333"}},methods:{getAttachPoints:function(bIsSource){var oBBox=this.getBBox();return{isFixedPoints:true,points:[[oBBox.x+oBBox.width-oBBox.height/2-1,oBBox.y+oBBox.height/2]]}}},statics:{objectClass:{value:"sap.modeling.flowgraph.Output"},layoutTemplate:{mainShape:[{shape:"RoundedRectangle",r:7,domClass:"node",stroke:"{stroke}",strokeWidth:"{strokeWidth}",fill:"{fill}",padding:0,width:50,height:14},{shape:"Text",domClass:"outputName",text:"{object/displayName}",font:"{font}",fill:"{textColor}",horizontalAlignment:"width",verticalAlignment:"height",isWordWrap:true,isEllipsis:true}]},events:{dragstart:function(oEvent,oSymbol,oExtension){var oEditor=oExtension.editor,oTool=oEditor.selectTool("sap.modeling.flowgraph.ui.FlowSymbol",false),aViewPoint,aClientPoint;oEvent.preventDefault();oEvent.stopPropagation();aClientPoint=oEditor.viewer.normalizePointerEvent(oEvent,false);aViewPoint=oEditor.viewer.clientPointToViewPoint(aClientPoint);oEvent.clientViewX=aViewPoint[0];oEvent.clientViewY=aViewPoint[1];oEvent._clientX=aClientPoint[0];oEvent._clientY=aClientPoint[1];oEvent._type="drag";oTool.isContextButton=true;oEvent.contextButtonSymbol=oSymbol;oTool.onPointerDown(oEvent);oTool.onDragStart(oEvent)},pointermove:function(oEvent,oSymbol,oExtension){var oEditor=oExtension.editor;if(oEditor.tool&&oEditor.tool.onPointerMove){oEditor.tool.onPointerMove(oEvent)}},drag:function(oEvent,oSymbol,oExtension){var oEditor=oExtension.editor;if(oEditor.tool&&oEditor.tool.onDrag){oEditor.tool.onDrag(oEvent)}},dragend:function(oEvent,oSymbol,oExtension){var oEditor=oExtension.editor;if(oEditor.tool&&oEditor.tool.onDragEnd){oEditor.tool.onDragEnd(oEvent)}}}}},FlowSymbol:{displayName:"Flow Symbol",parent:"sap.galilei.ui.diagram.LinkSymbol",properties:{"FlowSymbol.stroke":{name:"stroke",defaultValue:"#B3B3B3"},supportedSourceDirections:{defaultValue:function(){return[sap.galilei.ui.common.LinkDirection.west,sap.galilei.ui.common.LinkDirection.east]}},supportedTargetDirections:{defaultValue:function(){return[sap.galilei.ui.common.LinkDirection.west,sap.galilei.ui.common.LinkDirection.east]}},contentOffsetX:{dataType:sap.galilei.model.dataTypes.gDouble,defaultValue:15},contentOffsetY:{dataType:sap.galilei.model.dataTypes.gDouble,defaultValue:1}},statics:{objectClass:{value:"sap.modeling.flowgraph.Flow"},layoutTemplate:{stroke:"{stroke}",strokeWidth:1,lineStyle:"{lineStyle}",targetArrow:"Arrows.FilledEnd"}}}}}}};oResource=new sap.galilei.model.Resource();oReader=new sap.galilei.model.JSONReader();oReader.load(oResource,oDiagramDef)}());
(function(){sap.modeling.flowgraph.ui.DiagramEditorExtension=sap.galilei.ui.editor.defineDiagramEditorExtension({fullClassName:"sap.modeling.flowgraph.ui.DiagramEditorExtension",properties:{SUBGRAPH_SYMBOL:"sap.modeling.flowgraph.ui.SubGraphSymbol",NODE_SYMBOL:"sap.modeling.flowgraph.ui.NodeSymbol",INPUT_SYMBOL:"sap.modeling.flowgraph.ui.InputSymbol",OUTPUT_SYMBOL:"sap.modeling.flowgraph.ui.OutputSymbol",FLOW_SYMBOL:"sap.modeling.flowgraph.ui.FlowSymbol",SUBGRAPH_OBJECT:"sap.modeling.flowgraph.ui.SubGraph",NODE_OBJECT:"sap.modeling.flowgraph.Node",INPUT_OBJECT:"sap.modeling.flowgraph.Input",OUTPUT_OBJECT:"sap.modeling.flowgraph.Output",FLOW_OBJECT:"sap.modeling.flowgraph.Flow",SUBGRAPH_OBJECT_PARAM:"",NODE_OBJECT_PARAM:"",INPUT_OBJECT_PARAM:"",OUTPUT_OBJECT_PARAM:"",FLOW_OBJECT_PARAM:"",ADD_INPUT_COMMAND:"Sap.Modeling.Flowgraph.AddInput",ADD_OUTPUT_COMMAND:"Sap.Modeling.Flowgraph.AddOutput"},methods:{onInitialize:function(){this.addLinearGradient("nodeFill","#D4E7F8","#E8F2FA","#F9FBFC");this.editor.showConnectedSymbols=true},addLinearGradient:function(sGradientId,sStartColor,sMiddleColor,sStopColor){var oGradient=new sap.galilei.ui.common.style.LinearGradient({id:sGradientId,stops:[{offset:"5%",color:sStartColor},{offset:"50%",color:sMiddleColor},{offset:"85%",color:sStopColor}]});oGradient.createGradient(this.viewer)},canCreateObject:function(sObjectClassName,oParentObject,oProperties){switch(sObjectClassName){case this.NODE_OBJECT:if(oParentObject&&sap.galilei.model.isInstanceOf(oParentObject,this.NODE_OBJECT)){return false}break}return this.defaultCanCreateObject(sObjectClassName,oParentObject,oProperties)},postCreateSymbol:function(oSymbol){var self=this,sSymbolClass;function addInputsAndOutputs(){var nInputs=1,nOutputs=1,index,oCommand;for(index=0;index<nInputs;index++){oCommand=new sap.modeling.flowgraph.ui.AddInputCommand();oCommand.execute({editor:self.editor,symbol:oSymbol})}for(index=0;index<nOutputs;index++){oCommand=new sap.modeling.flowgraph.ui.AddOutputCommand();oCommand.execute({editor:self.editor,symbol:oSymbol})}}if(oSymbol){sSymbolClass=oSymbol.classDefinition.qualifiedName;switch(sSymbolClass){case this.NODE_SYMBOL:this.resource.applyUndoableAction(addInputsAndOutputs,"Add inputs and outputs");break}}},postDeleteSymbol:function(oContainer,oDeletedSymbol,bDeleteObject,bPreserveLink,bUseUndoAction){if(oContainer){switch(oContainer.classDefinition.qualifiedName){case this.NODE_SYMBOL:oContainer.updateBoundarySymbols(undefined,undefined,true,this.editor.viewer,this.editor.transitionDefinition);break}}},getContextButtonPad:function(oSymbol){var aButtons=[];if(oSymbol){switch(oSymbol.classDefinition.qualifiedName){case this.NODE_SYMBOL:aButtons.push({toolName:this.NODE_SYMBOL});aButtons.push({commandName:this.ADD_INPUT_COMMAND});aButtons.push({commandName:this.ADD_OUTPUT_COMMAND});break;case this.OUTPUT_SYMBOL:aButtons.push({toolName:this.FLOW_SYMBOL,tooltip:"Create Flow to an Input"});break}}this.addImagesFolder(aButtons);return aButtons},getToolsDefinition:function(){var self=this,oToolsDef;oToolsDef=[{name:this.SUBGRAPH_SYMBOL,type:sap.galilei.ui.editor.tool.Types.createNodeSymbolTool,tooltip:"Add SubGraph",symbolClass:this.SUBGRAPH_SYMBOL,objectParam:this.SUBGRAPH_OBJECT_PARAM,smallIcon:"Container16.png"},{name:this.NODE_SYMBOL,type:sap.galilei.ui.editor.tool.Types.createNodeSymbolTool,tooltip:"Add Node",symbolClass:this.NODE_SYMBOL,objectParam:this.NODE_OBJECT_PARAM,smallIcon:"Node16.png"},{name:this.FLOW_SYMBOL,type:sap.galilei.ui.editor.tool.Types.createLinkSymbolTool,tooltip:"Add Flow",smallIcon:"Flow16.png",cursor:"FlowCursor.png",linksDefinition:[{sourceSymbol:this.OUTPUT_SYMBOL,targetSymbol:this.INPUT_SYMBOL,linkSymbolClass:this.FLOW_SYMBOL,linkObjectParam:this.FLOW_OBJECT_PARAM}]}];this.addImagesFolder(oToolsDef);return oToolsDef},getCommandsDefinition:function(){var self=this,oCommandsDef;oCommandsDef=[{name:this.ADD_INPUT_COMMAND,className:"sap.modeling.flowgraph.ui.AddInputCommand",tooltip:"Add Input",smallIcon:"AddInput.png"},{name:this.ADD_OUTPUT_COMMAND,className:"sap.modeling.flowgraph.ui.AddOutputCommand",tooltip:"Add Output",smallIcon:"AddOutput.png"}];this.addImagesFolder(oCommandsDef);return oCommandsDef}}})}());
